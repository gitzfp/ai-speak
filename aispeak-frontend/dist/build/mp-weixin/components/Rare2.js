"use strict";const t=require("../common/vendor.js"),e={name:"Seekbar",props:{id:{default:"canvas"},width:{default:220},processVal:{default:0},max:{default:100},step:{default:1},startDeg:{default:0},endDeg:{default:2},innerLineWidth:{default:1},innerColor:{default:"#49CEB0"},innerLineDash:{default:!1},border:{default:10},process:{default:8},colorSatrt:{default:"#C4C4C4"},colorEnd:{default:()=>["#49CEB0","#49CEB0"]},isCounterClockWise:{default:!1},sliderSize:{default:0},indoorCircleSize:{default:0},sliderColor:{default:"#FFFFFF"},indoorCircleColor:{default:"#87ae3f"},isShowSlider:{default:!0},lock:{default:!1},isShowText:{default:!0},pageBg:{default:""}},data(){return{val:0,center:this.width/2,radius:this.width/2-30,residueDeg:2-this.startDeg,animate:null,isDown:!1,p:{}}},mounted(){this.val=this.processVal,this.draw(this.val)},watch:{processVal(t){this.val=t,this.draw(t)},max(t){this.max=t,this.draw(this.val)},lock(t){this.lock=t,this.draw(this.val)}},methods:{draw(e){const i=t.index.createCanvasContext(this.id,this);i.setLineCap("round"),i.clearRect(0,0,this.width,this.width),i.save();let s=this.isCounterClockWise?Math.PI*(2-this.startDeg):Math.PI*this.startDeg,h=this.isCounterClockWise?Math.PI*(2-this.endDeg):Math.PI*this.endDeg,r="string"==typeof this.innerColor?this.innerColor:this.setLinearGradient(this.innerColor,i);i.beginPath(),this.innerLineDash&&i.setLineDash([this.innerLineDash,this.innerLineDash],1),i.setLineWidth(this.innerLineWidth),i.setStrokeStyle(r),i.arc(this.center,this.center,this.radius-30,s,h,this.isCounterClockWise),i.beginPath(),this.innerLineDash&&i.setLineDash([1,0],1),i.setLineWidth(this.border),i.setStrokeStyle(this.colorSatrt),i.arc(this.center,this.center,this.radius,s,h,this.isCounterClockWise),i.stroke();let a=this.valToDeg(e),n="string"==typeof this.colorEnd?this.colorEnd:this.setLinearGradient(this.colorEnd,i);i.beginPath(),i.setLineWidth(this.process),i.setStrokeStyle(n),i.arc(this.center,this.center,this.radius,s,a,this.isCounterClockWise),i.stroke(),i.font=this.center/2+"px",i.setFontSize(36),i.setFillStyle(n),i.setTextAlign("center"),i.setTextBaseline("middle"),this.isShowText&&i.fillText(this.val,this.center,this.center),i.draw()},valToDeg(t){let e=(this.endDeg-this.startDeg)/this.max*t;return this.isCounterClockWise&&0!=e&&(e=2-e),((this.isCounterClockWise?2-this.startDeg:this.startDeg)+e)*Math.PI},setLinearGradient(t,e){const i=e.createLinearGradient(0,0,0,this.width);return t.forEach(((e,s)=>{0==s?i.addColorStop(0,e):s==t.length-1?i.addColorStop(1,e):i.addColorStop(1/t.length*(s+1),e)})),i},DegToXY(t){let e=2*Math.PI-t;return this.respotchangeXY({x:this.radius*Math.cos(e),y:this.radius*Math.sin(e)})},respotchangeXY(t){return{x:(t=>t+this.center)(t.x),y:(t=>this.center-t)(t.y)}},throttle(t){let e=0;return function(){let i=Date.now(),s=this,h=arguments;i-e>10&&(t.apply(s,h),e=i)}},spotchangeXY(t){return{x:(t=>t-this.center)(t.x),y:(t=>this.center-t)(t.y)}},XYToDeg(t,e){let i,s=Math.atan(e/t);return t>=0&&e>=0&&(i=s),t<=0&&e>=0&&(i=s+Math.PI),t<=0&&e<=0&&(i=s+Math.PI),t>0&&e<0&&(i=s+2*Math.PI),i},touchStart(t){if(this.lock)return!1;const e=t.mp.changedTouches[0]||t.changedTouches[0];let i=e.x,s=e.y,h=this.P,r=h.x-this.sliderSize-10,a=h.x+this.sliderSize+10,n=h.y-this.sliderSize-10,o=h.y+this.sliderSize+10;this.isDown=r<i&&i<a&&n<s&&s<o},touchMove(t){if(!this.isDown)return;const e=t.mp.changedTouches[0]||t.changedTouches[0];let i={};i.x=e.x,i.y=e.y;let s=this.spotchangeXY(i),h=this.XYToDeg(s.x,s.y);h=this.isCounterClockWise?h:2*Math.PI-h;const r=h/Math.PI;let a=(r-(r>this.startDeg?this.startDeg:-this.residueDeg))/(this.endDeg-this.startDeg)*this.max;a>100||a<0||(a>=this.max&&(a=this.max),a<=0&&(a=0),Math.abs(a-this.val)>10||(this.animate=requestAnimationFrame(this.draw.bind(this,a)),this.val!=Math.round(a)&&(this.val=Math.round(a),this.$emit("change",this.val))))},touchEnd(t){this.$emit("mouseUp",this.val),cancelAnimationFrame(this.animate),this.isDown=!1}}};const i=t._export_sfc(e,[["render",function(e,i,s,h,r,a){return{a:s.id,b:s.width+"px",c:s.width/1+"px",d:t.o(((...t)=>a.touchStart&&a.touchStart(...t))),e:t.o(((...t)=>a.touchMove&&a.touchMove(...t))),f:t.o(((...t)=>a.touchEnd&&a.touchEnd(...t))),g:s.pageBg}}]]);wx.createComponent(i);
