"use strict";const e=require("../../common/vendor.js"),o=require("../../api/account.js");require("../../axios/api.js"),require("../../config/env.js");const n=e.defineComponent({__name:"index",setup(n){const t=e.ref(!1),a=e.ref(!1),i=e.ref(""),l=e.ref("");e.onMounted((()=>{e.index.setNavigationBarTitle({title:"AISPeak"}),e.index.getSystemInfoSync&&(console.log("当前平台：",e.index.getSystemInfoSync().platform),a.value="wechat"===e.index.getSystemInfoSync().platform||"devtools"===e.index.getSystemInfoSync().platform);let o=e.index.getStorageSync("x-token");o&&r(o)}));const s=n=>{t.value||(t.value=!0,e.index.login({provider:"weixin",success:e=>{const n=e.code;o.accountRequest.wechatLogin({code:n}).then((e=>{u(e)})).finally((()=>{t.value=!1}))},fail:e=>{console.error("微信登录失败",e),t.value=!1}}))},c=()=>{console.log("手机号登录"),t.value||(t.value=!0,o.accountRequest.phoneLogin({phone_number:i.value,password:l.value}).then((e=>{u(e)})).finally((()=>{t.value=!1})))},u=o=>{if(1e3!==o.code)return void e.index.showToast({title:o.message,icon:"none"});let n=o.data.token;r(n)},r=o=>{e.index.setStorageSync("x-token",o),e.index.switchTab({url:"/pages/textbook/index"})};return(o,n)=>e.e({a:a.value},a.value?{b:e.o(s)}:{c:i.value,d:e.o((e=>i.value=e.detail.value)),e:l.value,f:e.o((e=>l.value=e.detail.value)),g:e.o(c)})}}),t=e._export_sfc(n,[["__scopeId","data-v-59c19a20"]]);wx.createPage(t);
